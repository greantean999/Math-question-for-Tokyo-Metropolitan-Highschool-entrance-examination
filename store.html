<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>特訓ストア - ライセンス有効化</title>
    <script src="auth.js"></script>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: auto; padding: 20px; background: #fdf6e3; line-height: 1.5; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 20px; border-top: 6px solid #268bd2; }
        .pkg-list { font-size: 0.9em; color: #555; background: #eee; padding: 10px; border-radius: 8px; height: 120px; overflow-y: scroll; }
        .action-btn { width: 100%; padding: 15px; font-size: 18px; border-radius: 12px; border: none; background: #268bd2; color: white; cursor: pointer; font-weight: bold; }
        input[type="text"], input[type="number"] { width: calc(100% - 24px); padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; }
        .price-display { font-size: 1.2em; font-weight: bold; color: #859900; margin: 10px 0; }
        .back-link { display: block; text-align: center; margin-bottom: 15px; text-decoration: none; color: #268bd2; font-weight: bold; }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← メニューに戻る</a>
    <h1>教材ストア</h1>

    <div class="card">
        <h2>ライセンスキー入力</h2>
        <p style="font-size: 0.8em; color: #666;">購入したキーを入力して全機能を解放します。</p>
        <input type="text" id="key-input" placeholder="ライセンスキーを入力">
        <button onclick="applyKey()" class="action-btn">有効化する</button>
        <div id="status-msg" style="margin-top: 10px; font-weight: bold; text-align: center;"></div>
    </div>

    <div class="card" style="border-top-color: #859900;">
        <h3>塾・学校での団体利用</h3>
        <p>10名様以上の同時申し込みで、<strong>全額から10%OFF</strong>いたします。</p>
        <label>予定生徒数：</label>
        <input type="number" id="std-count" value="10" min="1" oninput="calc()">
        <div class="price-display" id="total-price">合計：18,000円</div>
        <p style="font-size:0.7em;">※大問1セット（2,000円）を団体購入した際のシミュレーションです。</p>
        <button class="action-btn" style="background:#859900;" onclick="alert('お問い合わせフォームへ移動します')">団体購入を相談する</button>
    </div>

    <div class="card" style="border-top-color: #666;">
        <h3>対象パッケージ</h3>
        <div style="background: #eee8d5; padding: 20px; border-radius: 12px; margin-top: 20px;">
    <h3 style="margin-top:0;">法人・団体様用 見積シミュレーター</h3>
    
    <label>1. パックを選択してください：</label><br>
    <select id="pack-select" style="width: 100%; padding: 10px; margin: 10px 0; border-radius: 5px;">
        <option value="300">パック(1)〜(9)：大問1 個別 (各300円)</option>
        <option value="2000">パック(10)：大問1 フルセット (2,000円)</option>
        <option value="500">パック(11)〜(14)：大問2〜5 個別 (各500円)</option>
        <option value="3500">パック(15)：全問オールインワン (3,500円)</option>
    </select>

    <label>2. 利用生徒数を入力：</label><br>
    <input type="number" id="student-count" value="10" min="1" 
           style="width: 100px; padding: 10px; margin: 10px 0; border-radius: 5px;"> 名

    <hr style="border: 0; border-top: 1px solid #93a1a1;">

    <div style="text-align: right; font-weight: bold;">
        <p>1名あたりの単価: <span id="unit-price">¥300</span></p>
        <p style="font-size: 1.2rem; color: #d33682;">
            推定合計金額: <span id="total-price">¥3,000</span>
        </p>
    </div>
    
    <button onclick="requestQuote()" style="width: 100%; background: #268bd2; color: white; border: none; padding: 12px; border-radius: 5px; cursor: pointer;">
        この内容で利用を申し込む（窓口へ）
    </button>
</div>

<script>
    const packSelect = document.getElementById('pack-select');
    const studentInput = document.getElementById('student-count');
    const unitDisplay = document.getElementById('unit-price');
    const totalDisplay = document.getElementById('total-price');

    function calculate() {
        const unit = parseInt(packSelect.value);
        const count = parseInt(studentInput.value) || 0;
        const total = unit * count;

        unitDisplay.innerText = `¥${unit.toLocaleString()}`;
        totalDisplay.innerText = `¥${total.toLocaleString()}`;
    }

    packSelect.onchange = calculate;
    studentInput.oninput = calculate;

    function requestQuote() {
        const packName = packSelect.options[packSelect.selectedIndex].text;
        const count = studentInput.value;
        const total = totalDisplay.innerText;
        
        alert(`【お申し込み内容の確認】\n内容：${packName}\n人数：${count}名\n合計：${total}\n\nこの内容で事務局へメールを作成します。`);
        // 実際にはここでmailto:などを飛ばすとスマートです
    }
</script>
        <div class="pkg-list">
    <p style="color:#d33682; font-weight:bold; margin-bottom:10px;">★全(1)〜(9) 合計100問以上の圧倒的問題数！</p>
    ・大問1：(1)〜(9) 各300円<br>
    ・<strong>大問1：フルパック 2,000円</strong> (700円お得！)<br><br>
    ・<strong style="font-size:1.1rem; color:#268bd2;">全問オールインワン 3,500円</strong><br>
    　<span style="border-bottom: 2px solid #d33682;">【購入特典】大問1〜5 弱点診断付き・模擬試験モード</span>
    </div>

    <script>
        // ... applyKey関数などはそのまま ...

        function calc() {
            const count = document.getElementById('std-count').value;
            let unit = 2000; // 大問1セットの価格を基準に計算
            let total = count * unit;
            if (count >= 10) total *= 0.9;
            document.getElementById('total-price').innerText = `合計：${Math.floor(total).toLocaleString()}円`;
        }
        calc();
    </script>
</body>
</html>
