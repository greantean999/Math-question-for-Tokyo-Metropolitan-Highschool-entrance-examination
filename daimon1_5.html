<!DOCTYPE html>
<html lang="ja">
<head>
    <script src="auth.js"></script>
    <meta charset="UTF-8">
    <title>都立数学特訓 - 大問1(5) 二次方程式</title>
    <script>window.MathJax = { tex: { inlineMath: [['$', '$']] } };</script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: auto; padding: 20px; background: #fdf6e3; }
        .back-link { text-decoration: none; color: #268bd2; font-weight: bold; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center; }
        .prob-text { font-size: 1.8rem; margin: 40px 0; min-height: 80px; color: #073642; line-height: 1.4; }
        .action-btn { width: 100%; padding: 15px; font-size: 18px; border-radius: 12px; border: none; background: #268bd2; color: white; cursor: pointer; font-weight: bold; margin-bottom: 10px; }
        .ans-box { display: none; margin-top: 20px; padding: 20px; background: #eee8d5; border-radius: 10px; border: 2px solid #268bd2; }
        .step { text-align: left; font-size: 0.9rem; color: #555; margin-top: 10px; }
    </style>
</head>
<body>

<a href="daimon1.html" class="back-link">← 大問1メニューへ</a>

<div class="card">
    <div id="prob-text" class="prob-text">読み込み中...</div>
    <button class="action-btn" onclick="showAnswer()">答えを表示</button>
    <button class="action-btn" style="background:#859900;" onclick="nextProblem()">次の問題</button>

    <div id="ans-area" class="ans-box">
        <div id="ans-text" style="font-size: 1.4rem; font-weight: bold; color: #d33682; margin-bottom: 10px;"></div>
        <div id="exp-text" class="step"></div>
    </div>
</div>

<script>
    const database = [
        { q: String.raw`$x^2 + 5x + 6 = 0$`, a: String.raw`$x = -2, -3$`, e: String.raw`因数分解して：$(x+2)(x+3)=0$ よって $x = -2, -3$` },
        { q: String.raw`$x^2 - x - 12 = 0$`, a: String.raw`$x = 4, -3$`, e: String.raw`因数分解して：$(x-4)(x+3)=0$ よって $x = 4, -3$` },
        { q: String.raw`$x^2 + 2x - 1 = 0$`, a: String.raw`$x = -1 \pm \sqrt{2}$`, e: String.raw`因数分解できないので解の公式：<br>$x = \frac{-2 \pm \sqrt{2^2 - 4(1)(-1)}}{2} = \frac{-2 \pm \sqrt{8}}{2} = \frac{-2 \pm 2\sqrt{2}}{2} = -1 \pm \sqrt{2}$` },
        { q: String.raw`$x^2 = 7x$`, a: String.raw`$x = 0, 7$`, e: String.raw`$x^2 - 7x = 0$<br>$x(x - 7) = 0$ よって $x = 0, 7$。$x$で割ってしまわないように注意！` },
        { q: String.raw`$(x + 2)^2 = 5$`, a: String.raw`$x = -2 \pm \sqrt{5}$`, e: String.raw`平方根の考え方で：$x + 2 = \pm \sqrt{5}$ よって $x = -2 \pm \sqrt{5}$` },
        { q: String.raw`$2x^2 + 5x + 1 = 0$`, a: String.raw`$x = \frac{-5 \pm \sqrt{17}}{4}$`, e: String.raw`解の公式：$x = \frac{-5 \pm \sqrt{25 - 8}}{4} = \frac{-5 \pm \sqrt{17}}{4}$` },
        { q: String.raw`$x^2 - 10x + 25 = 0$`, a: String.raw`$x = 5$`, e: String.raw`$(x - 5)^2 = 0$ よって $x = 5$ (重解)` },
        { q: String.raw`$x^2 - 9 = 0$`, a: String.raw`$x = \pm 3$`, e: String.raw`$x^2 = 9$ より $x = \pm 3$。または $(x-3)(x+3)=0$` },
        { q: String.raw`$x^2 - 6x + 2 = 0$`, a: String.raw`$x = 3 \pm \sqrt{7}$`, e: String.raw`解の公式：$x = \frac{6 \pm \sqrt{36 - 8}}{2} = \frac{6 \pm \sqrt{28}}{2} = \frac{6 \pm 2\sqrt{7}}{2} = 3 \pm \sqrt{7}$` },
        { q: String.raw`$x^2 - 3x - 1 = 0$`, a: String.raw`$x = \frac{3 \pm \sqrt{13}}{2}$`, e: String.raw`解の公式：$x = \frac{3 \pm \sqrt{9 - (-4)}}{2} = \frac{3 \pm \sqrt{13}}{2}$` }
    ];

    let currentProb = null;

    function nextProblem() {
        const isUnlocked = AuthManager.isUnlocked('daimon1_q5');
        let qIndex = isUnlocked ? Math.floor(Math.random() * database.length) : 0;

        currentProb = database[qIndex];
        document.getElementById('prob-text').innerHTML = currentProb.q;
        document.getElementById('ans-area').style.display = 'none';
        if(window.MathJax) MathJax.typesetPromise();
    }

    function showAnswer() {
        document.getElementById('ans-text').innerHTML = currentProb.a;
        document.getElementById('exp-text').innerHTML = "【解説】<br>" + currentProb.e;
        document.getElementById('ans-area').style.display = 'block';
        if(window.MathJax) MathJax.typesetPromise();
    }

    window.onload = nextProblem;
</script>
</body>
</html>
